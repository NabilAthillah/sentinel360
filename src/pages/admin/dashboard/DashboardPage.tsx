import { useEffect, useState } from 'react';
import { useSelector } from 'react-redux';
import { useNavigate } from 'react-router-dom';
import { toast } from 'react-toastify';
import { Site } from '../../../types/site';
import { RootState } from '../../../store';
import siteService from '../../../services/siteService';
import auditTrialsService from '../../../services/auditTrailsService';
import MainLayout from '../../../layouts/MainLayout';
import Map from '../../../components/Map';

const DashboardPage = () => {
    const navigate = useNavigate();
    const [sites, setSites] = useState<Site[]>([]);
    const user = useSelector((state: RootState) => state.user.user);
    const token = useSelector((state: RootState) => state.token.token);

    const hasPermission = (permissionName: string) =>
        user?.role?.permissions?.some((p) => p.name === permissionName);

    const fetchSites = async () => {
        if (!token) {
            navigate('/auth/login');
            return;
        }
        try {
            const response = await siteService.getAllSite(token);
            if (response.success) {
                setSites(response.data);
            }
        } catch (error) {
            console.error(error)
        }
    }

    function isToday(dateString: string) {
        const date = new Date(dateString);
        const now = new Date();

        return (
            date.getUTCFullYear() === now.getUTCFullYear() &&
            date.getUTCMonth() === now.getUTCMonth() &&
            date.getUTCDate() === now.getUTCDate()
        );
    }

    function checkLastLogin() {
        const lastLogin = user?.last_login;
        if (lastLogin && isToday(lastLogin)) {
            const notifShown = localStorage.getItem('notif_last_login');

            if (notifShown === 'false' || !notifShown) {
                toast.warning('You must change your password every 3 months!');
                localStorage.setItem('notif_last_login', 'true');
            }
        }
    }

    const audit = async () => {
        if (!token || !user) return;
        try {
            const title = `Access dashboard page`;
            const description = `User ${user.email} access dashboard page`;
            const status = 'success';
            await auditTrialsService.storeAuditTrails(token, user.id, title, description, status, 'access dashboard');
        } catch (error) {
            console.error(error);
        }
    }

    useEffect(() => {
        audit();
        fetchSites();
        checkLastLogin();
    }, []);

    return (
        <MainLayout>
            {/* <div className="flex flex-col gap-10 px-6 pb-20 w-full h-[calc(100vh-91px)]"> */}
            <div className="flex flex-col gap-10 px-6 pb-20 w-full">
                <h2 className="text-2xl leading-9 text-white font-noto">
                    Hello {user?.name}
                </h2>

                <div className='px-[156px] h-[630px] flex flex-col gap-6'>
                    {/* Row 1 */}
                    <div className='flex gap-6 flex-1 w-full'>
                        {hasPermission("list_employees") && (
                            <div
                                className="flex flex-col items-center justify-center rounded-2xl bg-[#2A1F2E] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform w-full min-w-[204px] max-w-[204px]"
                                onClick={() => navigate("/dashboard/employees")}>

                                <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0_29_3314)">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M38.8966 31.1367C42.0933 33.3067 44.3333 36.2467 44.3333 40.1667V47.1667H53.6666V40.1667C53.6666 35.0801 45.3366 32.0701 38.8966 31.1367Z" fill="#C76390" />
                                        <path d="M21 28.4997C26.1547 28.4997 30.3334 24.321 30.3334 19.1663C30.3334 14.0117 26.1547 9.83301 21 9.83301C15.8454 9.83301 11.6667 14.0117 11.6667 19.1663C11.6667 24.321 15.8454 28.4997 21 28.4997Z" fill="#C76390" />
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M34.9999 28.4997C40.1566 28.4997 44.3333 24.323 44.3333 19.1663C44.3333 14.0097 40.1566 9.83301 34.9999 9.83301C33.9033 9.83301 32.8766 10.0663 31.8966 10.393C33.8333 12.7963 34.9999 15.853 34.9999 19.1663C34.9999 22.4797 33.8333 25.5363 31.8966 27.9397C32.8766 28.2663 33.9033 28.4997 34.9999 28.4997Z" fill="#C76390" />
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M21 30.833C14.77 30.833 2.33331 33.9597 2.33331 40.1663V47.1663H39.6666V40.1663C39.6666 33.9597 27.23 30.833 21 30.833Z" fill="#C76390" />
                                    </g>
                                    <defs>
                                        <clipPath id="clip0_29_3314">
                                            <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                        </clipPath>
                                    </defs>
                                </svg>
                                </span>
                                <p className="text-white font-medium">Employees</p>
                            </div>
                        )}
                        {hasPermission("list_employee_attendances") && (
                            <div
                                className="flex flex-col items-center justify-center rounded-2xl bg-[#1E2535] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform w-1/2"
                                onClick={() => navigate("/dashboard/attendances")}>

                                <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M30 7.375C17.2284 7.375 6.875 17.7284 6.875 30.5C6.875 43.2715 17.2284 53.625 30 53.625C42.7715 53.625 53.125 43.2715 53.125 30.5C53.125 17.7284 42.7715 7.375 30 7.375ZM3.125 30.5C3.125 15.6574 15.1574 3.625 30 3.625C44.8428 3.625 56.875 15.6574 56.875 30.5C56.875 45.3428 44.8428 57.375 30 57.375C15.1574 57.375 3.125 45.3428 3.125 30.5ZM30 18.625C31.0355 18.625 31.875 19.4645 31.875 20.5V29.7232L37.5758 35.4242C38.308 36.1565 38.308 37.3435 37.5758 38.0758C36.8435 38.808 35.6565 38.808 34.9242 38.0758L28.6742 31.8258C28.3225 31.4743 28.125 30.9972 28.125 30.5V20.5C28.125 19.4645 28.9645 18.625 30 18.625Z" fill="#6992ED" />
                                    </svg>
                                    <defs>
                                        <clipPath id="clip0_29_3314">
                                            <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                        </clipPath>
                                    </defs>
                                </svg>
                                </span>
                                <p className="text-white font-medium">Attendance</p>
                            </div>
                        )}
                        <div className='w-1/2 flex flex-col gap-6'>
                            {hasPermission("list_e-occurrences") && (
                                <div
                                    className="flex flex-col items-center justify-center rounded-2xl bg-[#1E282E] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform"
                                    onClick={() => navigate("/dashboard/e-occurrences")}>

                                    <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <svg width="48" height="49" viewBox="0 0 48 49" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M46.5 25.79L43.62 5.45003C43.5628 4.51746 43.1525 3.64169 42.4727 3.00081C41.7928 2.35994 40.8943 2.00209 39.96 2.00003H8.04C7.12547 1.9966 6.24306 2.3371 5.56787 2.95394C4.89267 3.57078 4.47403 4.41891 4.395 5.33003L1.5 25.91C1.50062 26.3666 1.59553 26.8181 1.7788 27.2362C1.96206 27.6544 2.22972 28.0302 2.565 28.34C2.715 28.49 2.865 28.64 3.045 28.79C3.02286 28.8583 3.00778 28.9287 3 29V41.51C3.03916 42.6002 3.50703 43.6309 4.30192 44.3781C5.09681 45.1252 6.15447 45.5284 7.245 45.5H40.755C41.8455 45.5284 42.9032 45.1252 43.6981 44.3781C44.493 43.6309 44.9608 42.6002 45 41.51V29C45.007 28.9302 45.007 28.8598 45 28.79C45.18 28.64 45.33 28.49 45.48 28.34C45.8224 28.0126 46.0905 27.6155 46.2665 27.1756C46.4424 26.7358 46.5221 26.2633 46.5 25.79ZM7.38 5.61503C7.38779 5.44659 7.46124 5.2879 7.5846 5.17295C7.70796 5.058 7.87143 4.99592 8.04 5.00003H39.96C40.0533 5.00185 40.1452 5.02257 40.2302 5.06092C40.3152 5.09928 40.3916 5.15447 40.4547 5.22317C40.5178 5.29187 40.5663 5.37265 40.5973 5.46063C40.6283 5.5486 40.6411 5.64195 40.635 5.73503L43.5 26C42.9213 26.7325 42.1217 27.2585 41.22 27.5H6.795C5.88962 27.2575 5.08548 26.732 4.5 26L7.38 5.61503ZM42 41.51C41.9589 41.8031 41.8067 42.0693 41.5751 42.2535C41.3434 42.4377 41.0498 42.526 40.755 42.5H7.245C6.95015 42.526 6.65659 42.4377 6.42492 42.2535C6.19325 42.0693 6.04114 41.8031 6 41.51V30.395C6.26046 30.4585 6.527 30.4937 6.795 30.5H41.205C41.473 30.4937 41.7395 30.4585 42 30.395V41.51Z" fill="#7AE7DE" />
                                            <path d="M13.5 15.5H34.5C35.6935 15.5 36.8381 15.0259 37.682 14.182C38.5259 13.3381 39 12.1935 39 11C39 9.80653 38.5259 8.66193 37.682 7.81802C36.8381 6.97411 35.6935 6.5 34.5 6.5H13.5C12.3065 6.5 11.1619 6.97411 10.318 7.81802C9.47411 8.66193 9 9.80653 9 11C9 12.1935 9.47411 13.3381 10.318 14.182C11.1619 15.0259 12.3065 15.5 13.5 15.5ZM13.5 9.5H34.5C34.8978 9.5 35.2794 9.65804 35.5607 9.93934C35.842 10.2206 36 10.6022 36 11C36 11.3978 35.842 11.7794 35.5607 12.0607C35.2794 12.342 34.8978 12.5 34.5 12.5H13.5C13.1022 12.5 12.7206 12.342 12.4393 12.0607C12.158 11.7794 12 11.3978 12 11C12 10.6022 12.158 10.2206 12.4393 9.93934C12.7206 9.65804 13.1022 9.5 13.5 9.5Z" fill="#7AE7DE" />
                                        </svg>
                                        <defs>
                                            <clipPath id="clip0_29_3314">
                                                <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                    </span>
                                    <p className="text-white font-medium">e-Occurences</p>
                                </div>
                            )}
                            {hasPermission("show_attendance_settings") && (
                                <div
                                    className="flex flex-col items-center justify-center rounded-2xl bg-[#2D2F2C] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform"
                                    onClick={() => navigate("/dashboard/settings/attendance")}>
                                    <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <svg width="48" height="49" viewBox="0 0 48 49" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_29_3596)">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M23.4 30.901C19.9534 30.901 17.1595 28.0355 17.1595 24.5006C17.1595 20.9656 19.9534 18.1001 23.4 18.1001C26.8464 18.1001 29.6405 20.9656 29.6405 24.5006C29.6405 26.198 28.9828 27.8259 27.8128 29.0263C26.6425 30.2267 25.0552 30.901 23.4 30.901Z" stroke="#E2D374" stroke-width="6.00044" stroke-linecap="round" stroke-linejoin="round" />
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M39.9903 37.5033V33.2086C39.9903 32.1452 40.4021 31.1252 41.1353 30.3732L44.0965 27.3362C45.6233 25.7703 45.6233 23.2312 44.0965 21.6654L41.1353 18.6283C40.4021 17.8763 39.9903 16.8564 39.9903 15.7929V11.495C39.9903 9.28038 38.2397 7.48508 36.0805 7.48508H31.8902C30.8533 7.48508 29.8587 7.06259 29.1255 6.3106L26.1643 3.27358C24.6375 1.70764 22.1621 1.70764 20.6353 3.27358L17.6743 6.3106C16.9411 7.06259 15.9467 7.48508 14.9098 7.48508H10.7193C9.68185 7.48508 8.68696 7.908 7.95366 8.66069C7.22036 9.41339 6.80884 10.4341 6.80967 11.4982V15.7929C6.80964 16.8564 6.39774 17.8763 5.66453 18.6283L2.70345 21.6654C1.17665 23.2312 1.17665 25.7703 2.70345 27.3362L5.66453 30.3732C6.39774 31.1252 6.80964 32.1452 6.80967 33.2086V37.5033C6.80967 39.7179 8.56007 41.5132 10.7193 41.5132H14.9098C15.9467 41.5132 16.9411 41.9356 17.6743 42.6877L20.6353 45.7247C22.1621 47.2906 24.6375 47.2906 26.1643 45.7247L29.1255 42.6877C29.8587 41.9356 30.8533 41.5132 31.8902 41.5132H36.0773C37.1149 41.5142 38.1101 41.0921 38.844 40.3397C39.5778 39.5876 39.9903 38.5674 39.9903 37.5033Z" stroke="#E2D374" stroke-width="6.00044" stroke-linecap="round" stroke-linejoin="round" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_29_3596">
                                                    <rect width="48" height="48" fill="white" transform="translate(0 0.5)" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                        <defs>
                                            <clipPath id="clip0_29_3314">
                                                <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                    </span>
                                    <p className="text-white font-medium">Master Settings</p>
                                </div>
                            )}
                        </div>
                    </div>
                    {/* Row 2 */}
                    <div className='flex gap-6 flex-1 w-full'>
                        {hasPermission("list_sites") && (
                            <div
                                className="flex flex-col items-center justify-center rounded-2xl bg-[#2D2A41] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform w-full min-w-[204px] max-w-[204px]"
                                onClick={() => navigate("/dashboard/sites")}>
                                <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M52.08 50.947C52.0762 50.2776 52.0762 49.6101 52.08 48.9407C52.0912 47.4689 52.0875 45.997 52.0987 44.5251C52.11 43.1339 52.1493 41.7464 52.1568 40.357C52.1606 39.0314 52.1268 37.7095 52.1231 36.3876C52.1193 35.0207 52.0856 33.6557 52.0462 32.2889C52.0237 31.612 51.9993 30.9407 51.9506 30.2676C51.9 29.5307 51.9112 28.7957 51.9037 28.0589C51.8925 26.5907 51.7537 25.1301 51.7125 23.6639C51.675 22.2839 51.7087 20.8982 51.6731 19.5182C51.63 17.8476 51.6187 16.1826 51.6 14.512C51.5812 12.5639 51.6375 10.612 51.6262 8.66387C51.6262 8.57012 51.5868 8.48762 51.57 8.39574C51.6075 8.16887 51.6056 7.93824 51.5437 7.71512C51.4443 7.35699 51.1668 6.90887 50.8068 6.75512C50.4412 6.60137 50.1768 6.50199 49.7662 6.49449C49.6668 6.49074 49.5712 6.49824 49.4737 6.49824C49.2281 6.50574 48.9787 6.52074 48.7331 6.52074C48.0918 6.52449 47.4506 6.49074 46.815 6.45512C45.8081 6.39887 44.7937 6.38574 43.785 6.38574C43.4212 6.38574 43.0575 6.38762 42.6956 6.38949C39.8212 6.40074 36.9393 6.44387 34.0631 6.54324C32.5875 6.59387 31.1081 6.66699 29.6287 6.69324C28.0725 6.71949 26.52 6.69699 24.9637 6.69324C24.3525 6.69324 23.745 6.69324 23.1318 6.69324C22.2206 6.69699 21.3037 6.69699 20.3925 6.68949C18.8325 6.67824 17.2725 6.63137 15.7162 6.59762C15.6 6.59762 15.495 6.63887 15.3862 6.66512C15.2043 6.58262 15.0075 6.53012 14.8031 6.53012C14.0156 6.53012 13.3818 7.17887 13.3743 7.95887C13.3631 8.71074 13.3537 9.46449 13.3443 10.2182C13.23 10.192 13.1231 10.147 13.0012 10.147C12.9975 10.147 12.9918 10.147 12.9881 10.147C12.105 10.1507 11.2237 10.162 10.3368 10.1845C9.43122 10.2051 8.67747 10.9232 8.67747 11.8457C8.67747 12.7251 9.43122 13.537 10.3368 13.5051C11.2237 13.4714 12.105 13.4282 12.9881 13.3907C13.0968 13.3851 13.1925 13.3439 13.2956 13.3214C13.275 14.5307 13.2525 15.7401 13.2131 16.9476C13.2131 16.9757 13.2112 17.0057 13.2112 17.0339C12.9581 17.0545 12.7143 17.0957 12.495 17.1932C11.7956 17.2195 11.0962 17.257 10.3987 17.2982C9.51935 17.3526 8.7806 17.9939 8.7806 18.9164C8.7806 19.747 9.51747 20.5964 10.3987 20.5307C11.1562 20.4726 11.9175 20.4107 12.675 20.332C12.8193 20.3789 12.975 20.3639 13.1268 20.3676C13.1231 20.5607 13.1156 20.7557 13.1118 20.9489C13.0856 22.252 13.05 23.5589 13.0425 24.8639C12.5437 24.9126 12.045 24.9689 11.5462 24.9801C10.8543 24.9951 10.1625 24.9726 9.4706 24.9726C8.58372 24.9726 7.84497 25.7132 7.84497 26.5982C7.84497 27.4776 8.5856 28.2351 9.4706 28.2239C10.1231 28.2164 10.7775 28.2089 11.43 28.162C11.9643 28.1245 12.5006 28.0851 13.0387 28.0607C13.0425 28.7395 13.05 29.4201 13.0762 30.0989C13.1006 30.7514 13.095 31.4039 13.1062 32.0545C13.0481 32.062 12.99 32.0601 12.9318 32.0751C12.8231 32.1014 12.7143 32.1201 12.6056 32.1389C12.2137 32.1707 11.8181 32.1632 11.4243 32.1632C10.7643 32.1595 10.1062 32.1557 9.44247 32.1557C8.58185 32.1557 7.85997 32.8739 7.85997 33.742C7.85997 34.5989 8.5781 35.3357 9.44247 35.3245C10.6725 35.3151 11.9062 35.2757 13.1381 35.2926C13.125 36.6276 13.1062 37.9645 13.0818 39.3051C13.0762 39.5676 13.08 39.8301 13.0762 40.0926C12.7481 40.1132 12.42 40.1414 12.0862 40.1395C11.265 40.1357 10.4418 40.1132 9.62247 40.117C8.73185 40.1245 7.98747 40.8576 7.98747 41.7501C7.98747 42.6257 8.72997 43.4095 9.6206 43.387C10.3743 43.3682 11.1262 43.3364 11.88 43.3176C12.2718 43.3064 12.6656 43.312 13.0556 43.3401C13.0556 43.3589 13.0556 43.3795 13.0556 43.3982C13.0593 44.6001 13.0631 45.8001 13.0725 47.0001C12.9093 47.0039 12.7462 47.0095 12.5831 47.0095C12.4218 47.0095 12.2643 47.0095 12.1068 47.0095C11.3962 47.0207 10.6856 47.047 9.97497 47.0789C9.1106 47.122 8.38497 47.7707 8.38497 48.6726C8.38497 49.4957 9.1106 50.317 9.97497 50.2626C10.7325 50.2157 11.4956 50.1707 12.2531 50.1276C12.5306 50.1107 12.81 50.0957 13.0893 50.0826C13.0875 50.1126 13.0893 50.1407 13.0875 50.1707C13.05 50.9132 13.05 51.6576 13.0143 52.4001C12.9881 52.9776 13.3443 53.4689 13.8225 53.7501C14.1112 54.1814 14.5875 54.4739 15.1443 54.5039C16.8543 54.5995 18.5831 54.6351 20.2968 54.5957C21.0806 54.577 21.8643 54.5189 22.6481 54.4645C23.3943 54.4139 24.1312 54.3914 24.8812 54.3989C26.5143 54.4176 28.14 54.4326 29.7731 54.3951C31.3875 54.3576 33.0037 54.3482 34.6143 54.4457C36.0675 54.5376 37.5337 54.5601 38.9868 54.4926C40.4156 54.4307 41.85 54.4007 43.2825 54.412C45.6075 54.4307 47.9325 54.4889 50.2593 54.3932C50.6493 54.3764 50.9943 54.2226 51.2887 54.0051C51.3018 53.9995 51.3112 53.9901 51.3225 53.9826C51.3956 53.9264 51.4706 53.8757 51.5343 53.8082C51.7706 53.6132 51.9675 53.3732 52.0368 53.0601C52.1325 52.6345 52.1062 52.2464 52.0875 51.8264C52.0762 51.532 52.08 51.2395 52.08 50.947ZM48.9675 51.0295C47.7337 51.1251 46.4831 51.1082 45.2512 51.1195C43.8187 51.1345 42.3843 51.142 40.9518 51.1926C39.3375 51.247 37.725 51.3032 36.1068 51.2695C35.2837 51.2545 34.4625 51.1889 33.6393 51.1851C32.8162 51.1776 31.9912 51.1964 31.1718 51.2039C29.8275 51.2151 28.4868 51.2339 27.1481 51.2432C26.5406 51.247 25.9293 51.2282 25.32 51.2207C24.66 51.2132 24.0056 51.247 23.3493 51.2826C22.0743 51.3595 20.8143 51.5132 19.5375 51.4982C18.4331 51.487 17.3306 51.4139 16.2262 51.3464C16.2318 51.0782 16.2243 50.812 16.2393 50.5439C16.2731 49.9401 16.2618 49.3326 16.2693 48.727C16.2806 48.0539 16.2731 47.3751 16.2693 46.702C16.2656 46.0907 16.2731 45.4757 16.2468 44.8664C16.2168 44.2101 16.2131 43.5557 16.2075 42.8995C16.2 42.1851 16.1606 41.4707 16.1381 40.7564C16.095 39.247 16.1193 37.7357 16.1381 36.2226C16.1681 33.2226 15.9843 30.2282 15.9806 27.232C15.9806 24.277 16.1193 21.3295 16.1756 18.3764C16.2018 16.8126 16.1062 15.2376 16.0912 13.6664C16.0781 12.2845 16.1306 10.9045 16.1793 9.52449C17.5837 9.52074 18.9881 9.47012 20.3925 9.44949C21.915 9.42699 23.4393 9.43074 24.9637 9.44199C28.0256 9.46449 31.0837 9.36512 34.1437 9.30699C35.565 9.27699 36.9862 9.25637 38.4056 9.25262C39.7968 9.24887 41.1843 9.28262 42.5775 9.29012C43.8956 9.29762 45.2175 9.33699 46.5281 9.46637C47.1731 9.52824 47.82 9.56949 48.465 9.61262C48.48 9.61449 48.495 9.61449 48.51 9.61449C48.5418 11.017 48.5831 12.4214 48.5775 13.8257C48.5737 15.2864 48.5081 16.7414 48.4893 18.202C48.4668 19.5501 48.4462 20.8982 48.4518 22.2445C48.4631 23.782 48.525 25.3214 48.5981 26.8589C48.6637 28.2426 48.6487 29.6339 48.7293 31.0232C48.8062 32.3714 48.8681 33.7251 48.8718 35.077C48.8868 37.732 48.9712 40.387 48.96 43.042C48.9525 44.737 48.9487 46.4339 48.9562 48.1289C48.9637 48.9351 48.975 49.7357 48.9675 50.542C48.9675 50.7032 48.9693 50.8664 48.9675 51.0295ZM46.5581 42.4907C46.5881 43.7207 46.6387 44.9451 46.6931 46.1714C46.7325 47.0432 45.9393 47.7726 45.0956 47.7726C44.1918 47.7726 43.5393 47.0432 43.4943 46.1714C43.4756 45.8057 43.5018 45.4382 43.4906 45.0726C43.4756 44.6432 43.4718 44.212 43.4756 43.7826C43.4831 43.0064 43.4531 42.2301 43.4531 41.4576C43.4531 40.7507 43.4681 40.0439 43.4606 39.337C43.4493 38.6114 43.4231 37.8876 43.41 37.1657C43.3762 35.6564 43.4475 34.1489 43.4531 32.6395C43.4606 31.1957 43.4793 29.7501 43.5037 28.3045C43.5337 26.722 43.5262 25.147 43.4962 23.5664C43.485 22.8332 44.115 22.2257 44.8368 22.2257C45.57 22.2257 46.17 22.8332 46.1737 23.5664C46.1887 25.522 46.1006 27.4776 46.0931 29.4332C46.0856 30.8901 46.1925 32.3414 46.2318 33.7982C46.2506 34.5745 46.2712 35.3507 46.2937 36.1307C46.3162 36.8339 46.3743 37.537 46.41 38.2401C46.4962 39.6557 46.5262 41.0732 46.5581 42.4907Z" fill="#4730E2" />
                                    </svg>
                                    <defs>
                                        <clipPath id="clip0_29_3314">
                                            <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                        </clipPath>
                                    </defs>
                                </svg>
                                </span>
                                <p className="text-white font-medium">Sites</p>
                            </div>
                        )}
                        <div className='w-1/2 flex flex-col gap-6'>
                            {hasPermission("list_incidents") && (
                                <div
                                    className="flex flex-col items-center justify-center rounded-2xl bg-[#1E282B] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform"
                                    onClick={() => navigate("/dashboard/incidents")}>
                                    <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_29_3572)">
                                                <path d="M30.4003 7.98791C32.4468 8.10416 34.1503 9.0801 35.1778 11.0638L51.9928 45.0089C53.6231 48.4401 51.0984 53.0573 46.9556 53.1238H13.094C9.3234 53.0638 6.22965 48.7823 8.07653 44.9713L25.2056 11.0273C25.5262 10.4179 25.6725 10.2417 25.949 9.92197C27.0609 8.63291 28.2768 7.94291 30.4003 7.98791ZM30.1237 11.7351C29.4797 11.767 28.89 12.1279 28.5684 12.6885C22.6509 23.9188 16.9462 35.2645 11.4112 46.6889C10.8993 47.8373 11.7778 49.311 13.0631 49.3729C24.3693 49.5557 35.6803 49.5557 46.9865 49.3729C48.2287 49.3129 49.1625 47.8879 48.645 46.701C43.214 35.2785 37.6153 23.9329 31.8018 12.7007C31.4587 12.0904 30.9553 11.7238 30.1237 11.7351Z" fill="#81E3A5" />
                                                <path d="M31.5291 38.545H28.3903L28.0453 23.124H31.8891L31.5291 38.545ZM27.9403 43.2606C27.9403 42.6896 28.125 42.2171 28.4953 41.8412C28.8666 41.4662 29.3719 41.2778 30.0122 41.2778C30.6534 41.2778 31.1587 41.4662 31.5291 41.8412C31.8994 42.2171 32.085 42.6896 32.085 43.2606C32.085 43.8109 31.9041 44.2712 31.5441 44.6415C31.1831 45.0118 30.6731 45.1975 30.0122 45.1975C29.3512 45.1975 28.8412 45.0118 28.4803 44.6415C28.1203 44.2712 27.9403 43.8109 27.9403 43.2606Z" fill="#81E3A5" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_29_3572">
                                                    <rect width="60" height="60" fill="white" transform="translate(0 0.5)" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                        <defs>
                                            <clipPath id="clip0_29_3314">
                                                <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                    </span>
                                    <p className="text-white font-medium">Incidents</p>
                                </div>
                            )}

                            {hasPermission("list_incidents") && (
                                <div
                                    className="flex flex-col items-center justify-center rounded-2xl bg-[#311F18] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform"
                                    onClick={() => navigate("/dashboard/leave-managements")}>
                                    <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M7.5 23H52.5M17.5 8V13M42.5 8V13M15 30.5H25V40.5H15V30.5ZM15.5 53H44.5C47.3002 53 48.7005 53 49.77 52.455C50.7108 51.9757 51.4757 51.2108 51.955 50.27C52.5 49.2005 52.5 47.8002 52.5 45V21C52.5 18.1997 52.5 16.7996 51.955 15.7301C51.4757 14.7892 50.7108 14.0243 49.77 13.545C48.7005 13 47.3002 13 44.5 13H15.5C12.6997 13 11.2996 13 10.2301 13.545C9.28923 14.0243 8.52432 14.7892 8.04497 15.7301C7.5 16.7996 7.5 18.1997 7.5 21V45C7.5 47.8002 7.5 49.2005 8.04497 50.27C8.52432 51.2108 9.28923 51.9757 10.2301 52.455C11.2996 53 12.6997 53 15.5 53Z" stroke="#BD441C" stroke-width="5" stroke-linecap="round" stroke-linejoin="round" />
                                        </svg>
                                        <defs>
                                            <clipPath id="clip0_29_3314">
                                                <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                    </span>
                                    <p className="text-white font-medium">Leave Management</p>
                                </div>
                            )}
                        </div>
                        <div className='w-1/2 flex gap-6'>
                            {hasPermission("list_audit_trails") && (
                                <div
                                    className="flex flex-col items-center justify-center rounded-2xl bg-[#232835] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform w-full"
                                    onClick={() => navigate("/dashboard/audit-trails")}>
                                    <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M58.1156 19.4357C58.1131 19.4609 58.1082 19.4852 58.1048 19.51C58.0999 19.5458 58.0956 19.5817 58.0886 19.6173C58.0827 19.6466 58.0746 19.6749 58.0674 19.7038C58.0597 19.7343 58.053 19.765 58.0438 19.7952C58.0352 19.8235 58.0246 19.8507 58.0148 19.8784C58.0041 19.9086 57.994 19.9388 57.9818 19.9686C57.9713 19.9938 57.9589 20.018 57.9473 20.0427C57.9329 20.0736 57.9191 20.1048 57.9028 20.135C57.8907 20.1578 57.8767 20.1793 57.8637 20.2014C57.8457 20.2319 57.8283 20.2627 57.8084 20.2923C57.7929 20.3155 57.7755 20.3372 57.759 20.3595C57.7393 20.3864 57.7205 20.4137 57.6991 20.4396C57.6719 20.4727 57.6425 20.5037 57.6131 20.5348C57.6004 20.5485 57.5891 20.5628 57.5759 20.576L48.2009 29.951C47.8492 30.3027 47.3723 30.5003 46.875 30.5003C46.3776 30.5003 45.9007 30.3027 45.549 29.951C45.1974 29.5994 44.9998 29.1224 44.9998 28.6251C44.9998 28.1278 45.1974 27.6509 45.549 27.2992L51.7234 21.1251H41.25C38.7644 21.128 36.3815 22.1166 34.624 23.8741C32.8664 25.6317 31.8778 28.0146 31.875 30.5001C31.871 33.9799 30.487 37.316 28.0264 39.7766C25.5658 42.2372 22.2297 43.6212 18.75 43.6251H18.5373C18.0763 45.6477 16.8864 47.4295 15.1949 48.6303C13.5034 49.8311 11.4288 50.3667 9.36737 50.1347C7.30597 49.9028 5.40226 48.9196 4.01987 47.3729C2.63747 45.8262 1.87329 43.8245 1.87329 41.7501C1.87329 39.6757 2.63747 37.674 4.01987 36.1273C5.40226 34.5807 7.30597 33.5975 9.36737 33.3655C11.4288 33.1336 13.5034 33.6692 15.1949 34.8699C16.8864 36.0707 18.0763 37.8526 18.5373 39.8751H18.75C21.2355 39.8723 23.6184 38.8836 25.3759 37.1261C27.1335 35.3686 28.1221 32.9857 28.125 30.5001C28.1289 27.0204 29.5129 23.6842 31.9735 21.2237C34.4341 18.7631 37.7702 17.379 41.25 17.3751H51.7234L45.549 11.201C45.1974 10.8494 44.9998 10.3724 44.9998 9.87512C44.9998 9.37781 45.1974 8.90087 45.549 8.54921C45.9007 8.19756 46.3776 8 46.875 8C47.3723 8 47.8492 8.19756 48.2009 8.54921L57.5759 17.9242C57.5891 17.9375 57.6004 17.9518 57.6131 17.9654C57.6425 17.9965 57.6719 18.0276 57.6991 18.0606C57.7205 18.0866 57.7393 18.1138 57.759 18.1407C57.7754 18.1631 57.7928 18.1848 57.8084 18.2079C57.8283 18.2376 57.8457 18.2683 57.8637 18.2989C57.8767 18.321 57.8907 18.3425 57.9028 18.3653C57.9191 18.3955 57.9329 18.4266 57.9473 18.4575C57.9589 18.4822 57.9713 18.5065 57.9818 18.5317C57.994 18.5614 58.0041 18.5916 58.0148 18.6218C58.0246 18.6495 58.0352 18.6768 58.0438 18.705C58.053 18.7353 58.0597 18.7659 58.0674 18.7965C58.0746 18.8253 58.0827 18.8537 58.0886 18.883C58.0955 18.9186 58.0999 18.9544 58.1048 18.9902C58.1082 19.0151 58.1131 19.0393 58.1156 19.0645C58.1278 19.188 58.1278 19.3123 58.1156 19.4357Z" fill="#1146C0" />
                                        </svg>
                                        <defs>
                                            <clipPath id="clip0_29_3314">
                                                <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                    </span>
                                    <p className="text-white font-medium">Audit Trails</p>
                                </div>
                            )}
                            {hasPermission("list_reports") && (
                                <div
                                    className="flex flex-col items-center justify-center rounded-2xl bg-[#2A2728] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform w-full"
                                    onClick={() => navigate("/dashboard/reports")}>
                                    <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M45 15.4999V17.3749H46.875V15.4999H45ZM12.6777 17.3749H45V13.6249H12.6777V17.3749ZM46.875 15.4999V11.265H43.125V15.4999H46.875ZM39.0278 4.45906L12.0338 8.31534L12.5641 12.0276L39.558 8.17136L39.0278 4.45906ZM12.0338 8.31534C9.79095 8.63574 8.125 10.5566 8.125 12.8222H11.875C11.875 12.4228 12.1687 12.0841 12.5641 12.0276L12.0338 8.31534ZM46.875 11.265C46.875 7.08119 43.1695 3.86739 39.0278 4.45906L39.558 8.17136C41.4408 7.90244 43.125 9.36323 43.125 11.265H46.875ZM12.6777 13.6249C12.2344 13.6249 11.875 13.2655 11.875 12.8222H8.125C8.125 15.3366 10.1633 17.3749 12.6777 17.3749V13.6249Z" fill="#C9894D" />
                                            <path d="M20 30.5H40" stroke="#C9894D" stroke-width="3.75" stroke-linecap="round" />
                                            <path d="M20 39.25H33.75" stroke="#C9894D" stroke-width="3.75" stroke-linecap="round" />
                                            <path d="M10 15.5V48C10 52.1423 13.3579 55.5 17.5 55.5H42.5C46.6423 55.5 50 52.1423 50 48V35.5M10 15.5V13M10 15.5H42.5C46.6423 15.5 50 18.8579 50 23V25.5" stroke="#C9894D" stroke-width="3.75" stroke-linecap="round" />
                                        </svg>
                                        <defs>
                                            <clipPath id="clip0_29_3314">
                                                <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                    </span>
                                    <p className="text-white font-medium">Reports</p>
                                </div>
                            )}
                        </div>
                    </div>
                </div>

                {/* <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <div className="flex flex-col items-center justify-center rounded-2xl bg-[#2A1F2E] p-6 shadow-md cursor-pointer hover:scale-105 transition-transform">
                        <span className="text-pink-400 text-4xl mb-3"><svg width="56" height="57" viewBox="0 0 56 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_29_3314)">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M38.8966 31.1367C42.0933 33.3067 44.3333 36.2467 44.3333 40.1667V47.1667H53.6666V40.1667C53.6666 35.0801 45.3366 32.0701 38.8966 31.1367Z" fill="#C76390" />
                                <path d="M21 28.4997C26.1547 28.4997 30.3334 24.321 30.3334 19.1663C30.3334 14.0117 26.1547 9.83301 21 9.83301C15.8454 9.83301 11.6667 14.0117 11.6667 19.1663C11.6667 24.321 15.8454 28.4997 21 28.4997Z" fill="#C76390" />
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M34.9999 28.4997C40.1566 28.4997 44.3333 24.323 44.3333 19.1663C44.3333 14.0097 40.1566 9.83301 34.9999 9.83301C33.9033 9.83301 32.8766 10.0663 31.8966 10.393C33.8333 12.7963 34.9999 15.853 34.9999 19.1663C34.9999 22.4797 33.8333 25.5363 31.8966 27.9397C32.8766 28.2663 33.9033 28.4997 34.9999 28.4997Z" fill="#C76390" />
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M21 30.833C14.77 30.833 2.33331 33.9597 2.33331 40.1663V47.1663H39.6666V40.1663C39.6666 33.9597 27.23 30.833 21 30.833Z" fill="#C76390" />
                            </g>
                            <defs>
                                <clipPath id="clip0_29_3314">
                                    <rect width="56" height="56" fill="white" transform="translate(0 0.5)" />
                                </clipPath>
                            </defs>
                        </svg>
                        </span>
                        <p className="text-white font-medium">Employees</p>
                    </div>
                </div> */}
            </div>
        </MainLayout>
    )
}

export default DashboardPage

// <MainLayout>
//     <div className='flex flex-col gap-10 px-6 pb-20 w-full h-[calc(100vh-91px)]'>
//         <h2 className='text-2xl leading-9 text-white font-noto'>Hello {user?.name}</h2>
//         <div className="flex-1">
//             <Map sites={sites} />
//             {/* <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d255281.22504611858!2d103.84425004999999!3d1.31400005!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31da11238a8b9375%3A0x887869cf52abf5c4!2sSingapore!5e0!3m2!1sen!2sid!4v1749491915888!5m2!1sen!2sid" loading="lazy" className="w-full h-full rounded-2xl"></iframe> */}
//         </div>
//     </div>
// </MainLayout>